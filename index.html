<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
  <head http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>Paul Calnan</title>
    <link rel="stylesheet" href="http://paulcalnan.com/theme/css/main.css" type="text/css"/>

    <link rel="stylesheet" href="http://paulcalnan.com/theme/highlight.js/styles/solarized_light.css">
    <script src="http://paulcalnan.com/theme/highlight.js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div class="main">
      <div class="header">
        <table width="100%" border="0" cellpadding="0">
          <tr>
            <td class="headerTitle">
              <a href="http://paulcalnan.com" style="text-decoration: none;">Paul Calnan</a>
            </td>
            <td class="headerLinks">
              <a href="http://paulcalnan.com/archives.html">Archives</a> |
<a href="http://paulcalnan.com/pages/about.html">About</a> |
<a href="http://twitter.com/pwc/">Twitter</a> |
<a href="http://github.com/pwc3/">Github</a>            </td>
          </tr>
          <tr>
            <td colspan="2" class="headerFoot">
              I love it when a plan comes together
            </td>
          </tr>
        </table>
      </div>

      
  <div class="post">
  <div class="postTitle">
    <a href="/archives/2014/8/textexpander-code-snippets-for-objective-c.html">TextExpander Code Snippets for Objective-C</a>
  </div>
    <div class="date">Published August 27, 2014</div>
  <p>I use a lot of TextExpander snippets when doing Objective-C development. I really like Objective-C, but it can be pretty verbose at times. If I find myself typing the same thing repeatedly, I make a new snippet for it.</p>
<p>The snippets make extensive use of Xcode placeholder tokens. For example:</p>
<pre><code>[NSString stringWithFormat:@"&lt;#format string#&gt;", &lt;#args#&gt;]
</code></pre>
<p>This will give you two placeholder "bubbles"; one for <em>format string</em> and the other for <em>args</em>. You can tab between the bubbles and replace them with whatever you need in that place.</p>
<h3>Initializers</h3>
<p>I use <code>;init</code> to insert a default initializer:</p>
<pre><code>- (instancetype)init
{
    if ((self = [super init]))
    {
        %|
    }
    return self;
}
</code></pre>
<p>Notice the use of <code>%|</code> which defines the cursor location after the snippet is expanded.</p>
<p>I also use <code>;iinit</code> to insert an initializer body (<code>iinit</code> for Inside Init):</p>
<pre><code>    if ((self = [super init]))
    {
        %|
    }
    return self;
</code></pre>
<p>That's useful for writing initializers with parameters. It's indented an extra four spaces since it's going inside the method body.</p>
<h3>Default Description Implementation</h3>
<p>I use <code>;desc</code> to generate a <code>-description</code> method that behaves like the default in <code>NSObject</code>. I can then build on it from there.</p>
<pre><code>- (NSString *)description
{
    return [NSString stringWithFormat:@"&lt;%@: %p&gt;", NSStringFromClass([self class]), self];
}
</code></pre>
<h3>UIViewController View Methods</h3>
<p><code>;vwa</code> generates a <code>-viewWillAppear:</code></p>
<pre><code>- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    %|
}
</code></pre>
<p><code>;vwd</code> generates a <code>-viewWillDisappear:</code></p>
<pre><code>- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    %|
}
</code></pre>
<p><code>;vda</code> generates a <code>-viewDidAppear:</code></p>
<pre><code>- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    %|
}
</code></pre>
<p><code>;vdd</code> generates a <code>-viewDidDisappear:</code></p>
<pre><code>- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
    %|
}
</code></pre>
<h3>Properties</h3>
<p>Variations for readonly, copy, strong, weak, and assign:</p>
<table>
<thead>
<tr>
<th align="left">Abbreviation</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>;pnra</code></td>
<td align="left"><code>@property (nonatomic, readonly, assign)</code></td>
</tr>
<tr>
<td align="left"><code>;pnrc</code></td>
<td align="left"><code>@property (nonatomic, readonly, copy)</code></td>
</tr>
<tr>
<td align="left"><code>;pnrs</code></td>
<td align="left"><code>@property (nonatomic, readonly, strong)</code></td>
</tr>
<tr>
<td align="left"><code>;pnrw</code></td>
<td align="left"><code>@property (nonatomic, readonly, weak)</code></td>
</tr>
<tr>
<td align="left"><code>;pna</code></td>
<td align="left"><code>@property (nonatomic, assign)</code></td>
</tr>
<tr>
<td align="left"><code>;pnc</code></td>
<td align="left"><code>@property (nonatomic, copy)</code></td>
</tr>
<tr>
<td align="left"><code>;pns</code></td>
<td align="left"><code>@property (nonatomic, strong)</code></td>
</tr>
<tr>
<td align="left"><code>;pnw</code></td>
<td align="left"><code>@property (nonatomic, weak)</code></td>
</tr>
</tbody>
</table>
<h3>The Strong-Self / Weak-Self Dance</h3>
<table>
<thead>
<tr>
<th align="left">Abbreviation</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>;ws</code></td>
<td align="left"><code>__weak typeof(self) weakSelf = self;</code></td>
</tr>
<tr>
<td align="left"><code>;ss</code></td>
<td align="left"><code>__strong typeof(weakSelf) strongSelf = weakSelf;</code></td>
</tr>
</tbody>
</table>
<h3>Private Read-Write Property Declarations</h3>
<p>Say you have a public interface for a class, like this:</p>
<pre><code>@interface SomeClass : NSObject
@property (nonatomic, readonly, copy) NSString *someString;
@property (nonatomic, readonly, copy) NSDictionary *someDictionary;
@end
</code></pre>
<p>If you want to generate a private declaration, simply copy the interface to the pasteboard and run <code>;dprivate</code>. This is a <em>shell script</em> snippet, that performs the following:</p>
<pre><code>#!/bin/sh
pbpaste | sed -e 's/ : .*$/ ()/' -e 's/, readonly//' | grep -v '^[-+]' | grep -v '^$'
</code></pre>
<p>Using the example above, this would output:</p>
<pre><code>@interface SomeClass ()
@property (nonatomic, copy) NSString *someString;
@property (nonatomic, copy) NSDictionary *someDictionary;
@end
</code></pre>
<h3>Mark Pragmas</h3>
<table>
<thead>
<tr>
<th align="left">Abbreviation</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>;mark</code></td>
<td align="left"><code>#pragma mark -</code></td>
</tr>
<tr>
<td align="left"><code>;public</code></td>
<td align="left"><code>#pragma mark - Public Methods</code></td>
</tr>
<tr>
<td align="left"><code>;private</code></td>
<td align="left"><code>#pragma mark - Private Methods</code></td>
</tr>
</tbody>
</table>
<h3>Declare and Initialize an Object using the Default Initializer</h3>
<p><code>;new</code> uses a fill-in for the type name and variable name:</p>
<pre><code>%filltext:name=typename% *%filltext:name=varname% = [%filltext:name=typename% new];
</code></pre>
<p>If you enter <code>NSMutableArray</code> and <code>array</code>, this will yield:</p>
<pre><code>NSMutableArray *array = [NSMutableArray new];
</code></pre>
<h3>Key-Value Observing Done Right</h3>
<p>I've long since lost where I got these, but it's the correct way to register for KVO notifications.</p>
<p>Declare a context variable static to the source file with <code>;kvocontext</code>:</p>
<pre><code>static void *kKVOContext = &amp;kKVOContext;
</code></pre>
<p>Register for KVO notifications in the initializer, <code>viewWillAppear</code>, etc. with <code>;kvoadd</code>:</p>
<pre><code>[&lt;#(id)#&gt; addObserver:self forKeyPath:&lt;#(NSString *)#&gt; options:&lt;#(NSKeyValueObservingOptions)#&gt; context:kKVOContext];
</code></pre>
<p>Deregister from KVO notifications in <code>dealloc</code>, <code>viewWillDisappear</code>, etc. with <code>;kvoremove</code>:</p>
<pre><code>[&lt;#(id)#&gt; removeObserver:&lt;#(NSObject *)#&gt; forKeyPath:&lt;#(NSString *)#&gt; context:kKVOContext];
</code></pre>
<p>And, finally, declare the KVO notification hander with <code>;kvomethod</code>:</p>
<pre><code>- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if (context != kKVOContext)
    {
        [super observeValueForKeyPath:keyPath ofObject:object change:change context:context];
        return;
    }

    if ([keyPath isEqualToString:&lt;#(NSString *)#&gt;])
    {
        %|
    }
}
</code></pre>
<h3>Documents Directory</h3>
<p>I used to have to look this up whenever I needed to use the documents directory. Now I use <code>;document</code>:</p>
<pre><code>NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *&lt;#path#&gt; = [documentsDirectory stringByAppendingPathComponent:&lt;#filename#&gt;];
</code></pre>
<p>The final <code>NSString</code> variable is the full path to a file in the documents directory.</p>
<h3>Common Type Names</h3>
<table>
<thead>
<tr>
<th align="left">Abbreviation</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>;nsa</code></td>
<td align="left"><code>NSArray</code></td>
</tr>
<tr>
<td align="left"><code>;nsd</code></td>
<td align="left"><code>NSDictionary</code></td>
</tr>
<tr>
<td align="left"><code>;nss</code></td>
<td align="left"><code>NSString</code></td>
</tr>
<tr>
<td align="left"><code>;nsma</code></td>
<td align="left"><code>NSMutableArray</code></td>
</tr>
<tr>
<td align="left"><code>;nsmd</code></td>
<td align="left"><code>NSMutableDictionary</code></td>
</tr>
<tr>
<td align="left"><code>;nsms</code></td>
<td align="left"><code>NSMutableString</code></td>
</tr>
</tbody>
</table>
<p>These also work with the <code>;new</code> snippet, above.</p>
<h3>Miscellaneous</h3>
<p>Reference the default <code>NSNotificationCenter</code> using <code>;dnc</code>:</p>
<pre><code>[NSNotificationCenter defaultCenter]
</code></pre>
<p>Make a new <code>NSString</code> by calling <code>-stringWithFormat:</code> with <code>;swf</code>. The <code>%key:tab%</code> at the end highlights the format string placeholder:</p>
<pre><code>[NSString stringWithFormat:@"&lt;#format string#&gt;", &lt;#args#&gt;]%key:tab%
</code></pre>
<p>Make a constant string whose value is equal to the variable name with <code>;cstr</code>:</p>
<pre><code>NSString *const %fill:name% = @"%fill:name%";
</code></pre>
<h3>Xcode Paths</h3>
<p>These are useful in the Terminal or in the <em>Go to Folder</em> dialog in the Finder.</p>
<table>
<thead>
<tr>
<th align="left">Abbreviation</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>;iossdks</code></td>
<td align="left"><code>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs</code></td>
</tr>
<tr>
<td align="left"><code>;osxsdks</code></td>
<td align="left"><code>/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs</code></td>
</tr>
<tr>
<td align="left"><code>;simulator</code></td>
<td align="left"><code>~/Library/Application\ Support/iPhone\ Simulator</code></td>
</tr>
<tr>
<td align="left"><code>;archives</code></td>
<td align="left"><code>~/Library/Developer/Xcode/Archives</code></td>
</tr>
<tr>
<td align="left"><code>;deriveddata</code></td>
<td align="left"><code>~/Library/Developer/Xcode/DerivedData</code></td>
</tr>
</tbody>
</table>
</div>
  <div class="post">
  <div class="postTitle">
    <a href="/archives/2014/8/objective-c-block-syntax-examples.html">Objective-C Block Syntax Examples</a>
  </div>
    <div class="date">Published August 12, 2014</div>
  <p><a href="http://fuckingblocksyntax.com">The canonical Objective-C block syntax reference</a> misses some cases that I use frequently. At the end of last year, as I was getting back into full-time Objective-C development, I made the following example file that covers every block usage I could think of. It is my go-to reference whenever I'm in doubt as to how to write a particular kind of block.</p>
<script src="https://gist.github.com/pwc3/9f4edc853be5a2e8f2e5.js"></script>
</div>
  <div class="post">
  <div class="postTitle">
    <a href="/archives/2014/3/xcode-git-status-with-applescript.html">Xcode Git Status with AppleScript</a>
  </div>
    <div class="date">Published March 30, 2014</div>
  <p>Here's another AppleScript I wrote. It would be great if Xcode would show the current Git branch and working directory status in the main window. Unfortunately, the only way to see the current branch is to select the <em>Source Control</em> menu. There's no quick way to see if you have uncommitted modifications.</p>
<p>I wrote this AppleScript, which I have bound to &#8997;<!--alt-->&#8679;<!--shift-->&#8984;<!--cmd-->G using <a href="http://www.red-sweater.com/fastscripts/">FastScripts</a>. It pops up a notification showing the current branch and status.</p>
<p>This is a notification showing the master branch with no changes or additions:</p>
<p><img alt="Clean Working Directory" src="/static/images/git_clean.png" title="Clean Working Directory" /></p>
<p>This is what it looks like when there are modifications:</p>
<p><img alt="Modified Files in Working Directory" src="/static/images/git_modified.png" title="Modified Files in Working Directory" /></p>
<p>And, this is the notification when there are modifications and additions:</p>
<p><img alt="Modified and Added Files in Working Directory" src="/static/images/git_modified_and_added.png" title="Modified and Added Files in Working Directory" /></p>
<p>The script:
<script src="https://gist.github.com/pwc3/9867443.js"></script></p>
</div>
  <div class="post">
  <div class="postTitle">
    <a href="/archives/2014/3/closing-tweetbot-image-windows-using-applescript.html">Closing Tweetbot Image Windows using AppleScript</a>
  </div>
    <div class="date">Published March 24, 2014</div>
  <p>I'm on a bit of an AppleScript kick lately. It's a frustrating language to use as it's often counterintuitive. I'm constantly looking up the right syntax to do things. But, it's a great way to patch little annoyances you encounter in Mac software.</p>
<p>The latest annoyance involves Tweetbot image windows. While I'm reading my timeline, I click on lots of links and images. After a while, I find I have a ton of image windows left over.</p>
<p>There's no good way to close all of those windows without quitting and restarting the app. Holding down &#8997;<!--alt--> and clicking on the Window menu shows <em>Close All</em> bound to &#8997;<!--alt-->&#8984;<!--cmd-->W, but it doesn't work for me. The alternative is to click on each window and &#8984;<!--cmd-->W on the keyboard, but who wants to do that?</p>
<p>I wrote a little AppleScript to do it. Tweetbot isn't strictly AppleScriptable, but using System Events and Accessiblity gets the job done. The script is a bit kludgy as the inner <code>repeat</code> loop fails after closing three or four windows. To get around it, I wrapped it in a <code>try...on error</code> block and repeat that until there's only one window left.</p>
<p>I've got this bound to &#8679;<!--shift-->&#8984;<!--cmd-->W using <a href="http://www.red-sweater.com/fastscripts/">FastScripts</a>.</p>
<p>The script:</p>
<script src="https://gist.github.com/pwc3/9754912.js"></script>
</div>
  <div class="post">
  <div class="postTitle">
    <a href="/archives/2014/3/refreshing-xcode-provisioning-profiles-with-applescript.html">Refreshing Xcode Provisioning Profiles with AppleScript</a>
  </div>
    <div class="date">Published March 24, 2014</div>
  <p>This seems to happen whenever someone on the team updates the provisioning profile and commits the change to the <code>.xcodeproj</code> file. The build fails and Xcode complains that it can't find a provisioning profile identified by a UUID.</p>
<p>To fix it, I have to stop what I'm doing, open Preferences, click the right Apple ID (I have one for each client), click the team, click <em>View Details</em>, click the refresh button, and then close out the action sheet and the Preferences dialog. Not the end of the world, but it gets old after a while.</p>
<p>To get around this issue, I wrote an AppleScript to automate the process. It's a bit fragile, as it's using Accessibility and System Events to poke around in the Preferences dialog. It probably will break in a later version of Xcode (it works in Xcode 5.1).</p>
<p>To use the script save it to your computer and set the <code>appleID</code> variable to your Apple ID. I use <a href="http://www.red-sweater.com/fastscripts/">FastScripts</a> to bind the script to &#8997;<!--alt-->&#8679;<!--shift-->&#8984;<!--cmd-->R while in Xcode.</p>
<p>The script:</p>
<script src="https://gist.github.com/pwc3/9754730.js"></script>
</div>

<div class="paginator">
  
  
      <a href="http://paulcalnan.com/index2.html">Older Posts</a>
  </div>

      <div id="copyright">
        <center>
          <a href="http://paulcalnan.com/archives.html">Archives</a> |
<a href="http://paulcalnan.com/pages/about.html">About</a> |
<a href="http://twitter.com/pwc/">Twitter</a> |
<a href="http://github.com/pwc3/">Github</a>          <br/><br/>
          &copy; 2013 Paul Calnan. All rights reserved.
        </center>
      </div>
    </div>

    <script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '51304dd7108d7b6aad000032');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>
  </body>
</html>